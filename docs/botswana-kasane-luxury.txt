 Pre-filter check: {
  productType: 'Packages',
  destination: 'Kasane Airport',
  class: 'luxury',
  productsBeforeFilter: 10
}
✅ Applying client-side destination/class filtering to preserve "On request" products
🎯 Applying pattern-based filtering for destination: "Kasane Airport", class: "luxury"
🎯 Class filter check - Value: 'luxury', Type: string, Empty: false
📦 Total products before filtering: 10
✅ BBKPKTVT001BOD6KM IS in the products array from TourPlan API
🔍 Checking product: BBKPKCHO004CHOLUX - "Chobe Safari Lodge - 2 Night Getaway Luxury" - Supplier: "Chobe Safari Lodge"
✅ BBKPKCHO004CHOLUX: Destination match using pattern matching (no API location data)
⚠️ BBKPKCHO004CHOLUX: No API class data available, using pattern matching fallback
❌ BBKPKCHO004CHOLUX: destination=true, class=false
🔍 Checking product: BBKPKCHO004CHOLWA - "Chobe Safari Lodge - 3 Night Safari Special" - Supplier: "Chobe Safari Lodge"
✅ BBKPKCHO004CHOLWA: Destination match using pattern matching (no API location data)
⚠️ BBKPKCHO004CHOLWA: No API class data available, using pattern matching fallback
❌ BBKPKCHO004CHOLWA: destination=true, class=false
🔍 Checking product: BBKPKCHO0153NIGPA - "Chobe Bush Lodge - 3 Night Safari Special" - Supplier: "Chobe Bush Lodge"
✅ BBKPKCHO0153NIGPA: Destination match using pattern matching (no API location data)
⚠️ BBKPKCHO0153NIGPA: No API class data available, using pattern matching fallback
❌ BBKPKCHO0153NIGPA: destination=true, class=false
🔍 Checking product: BBKPKCHO015BUSDEL - "Chobe Bush Lodge  - 2 Night Getaway Deluxe" - Supplier: "Chobe Bush Lodge"
✅ BBKPKCHO015BUSDEL: Destination match using pattern matching (no API location data)
⚠️ BBKPKCHO015BUSDEL: No API class data available, using pattern matching fallback
❌ BBKPKCHO015BUSDEL: destination=true, class=false
🔍 Checking product: BBKPKCHO015STDBUS - "Chobe Bush Lodge - 2 Night Getaway Luxury" - Supplier: "Chobe Bush Lodge"
✅ BBKPKCHO015STDBUS: Destination match using pattern matching (no API location data)
⚠️ BBKPKCHO015STDBUS: No API class data available, using pattern matching fallback
✅ BBKPKCHO015STDBUS: destination=true, class=true
🔍 Checking product: BBKPKCHOBAKBAK3DP - "Chobe Bakwena 3 Day Package" - Supplier: "Chobe Bakwena"
✅ BBKPKCHOBAKBAK3DP: Destination match using pattern matching (no API location data)
⚠️ BBKPKCHOBAKBAK3DP: No API class data available, using pattern matching fallback
❌ BBKPKCHOBAKBAK3DP: destination=true, class=false
🔍 Checking product: BBKPKCHOBAKBAK4DP - "Chobe Bakwena 4 Day Package" - Supplier: "Chobe Bakwena"
✅ BBKPKCHOBAKBAK4DP: Destination match using pattern matching (no API location data)
⚠️ BBKPKCHOBAKBAK4DP: No API class data available, using pattern matching fallback
❌ BBKPKCHOBAKBAK4DP: destination=true, class=false
🔍 Checking product: BBKPKCPKUZ CPKU2N - "Camp Kuzuma - 3 day package" - Supplier: "Camp Kuzuma (Dir)"
✅ BBKPKCPKUZ CPKU2N: Destination match using pattern matching (no API location data)
⚠️ BBKPKCPKUZ CPKU2N: No API class data available, using pattern matching fallback
✅ BBKPKCPKUZ CPKU2N: destination=true, class=true
🎯 FOUND BOD6KM product: BBKPKTVT001BOD6KM - "Waterways and Wilderness" - Supplier: "Tourvest"
🔍 Checking product: BBKPKTVT001BOD6KM - "Waterways and Wilderness" - Supplier: "Tourvest"
✅ BBKPKTVT001BOD6KM: Destination match using pattern matching (no API location data)
⚠️ BBKPKTVT001BOD6KM: No API class data available, using pattern matching fallback
❌ BBKPKTVT001BOD6KM: destination=true, class=false
🔍 Checking product: BBKPKTVT001CGLCOK - "Chobe and the Delta" - Supplier: "Tourvest"
✅ BBKPKTVT001CGLCOK: Destination match using pattern matching (no API location data)
⚠️ BBKPKTVT001CGLCOK: No API class data available, using pattern matching fallback
❌ BBKPKTVT001CGLCOK: destination=true, class=false
🎯 Dynamic filtering result: 10 → 2 products
✅ Matching products: [
  'BBKPKCHO015STDBUS - Chobe Bush Lodge - 2 Night Getaway Luxury',
  'BBKPKCPKUZ CPKU2N - Camp Kuzuma - 3 day package'
]
🎯 Applied dynamic destination filtering: 10 → 2 products
 GET /api/tourplan?productType=Packages&destination=Kasane+Airport&class=luxury 200 in 5206ms
 ✓ Compiled /api/tourplan/pricing/[productCode] in 480ms (412 modules)
📅 Using extended date range (2 years): { dateFrom: '2025-08-27', dateTo: '2025-11-25', months: 60 }
Getting pricing calendar for: {
  productCode: 'BBKPKCPKUZ CPKU2N',
  dateFrom: '2025-08-27',
  dateTo: '2025-11-25',
  adults: 2,
  children: 0,
  roomType: 'DB'
}
📊 Using Info parameter "GDMA" for product BBKPKCPKUZ CPKU2N (isRail: false, isCruise: false) - includes availability flags
Getting pricing for date range: BBKPKCPKUZ CPKU2N 2025-08-27 to 2025-11-25
🚂 Rail API request using Info="GDMA"
📅 Using extended date range (2 years): { dateFrom: '2025-08-27', dateTo: '2025-11-25', months: 60 }
Getting pricing calendar for: {
  productCode: 'BBKPKCHO015STDBUS',
  dateFrom: '2025-08-27',
  dateTo: '2025-11-25',
  adults: 2,
  children: 0,
  roomType: 'DB'
}
📊 Using Info parameter "GDMA" for product BBKPKCHO015STDBUS (isRail: false, isCruise: false) - includes availability flags
Getting pricing for date range: BBKPKCHO015STDBUS 2025-08-27 to 2025-11-25
🚂 Rail API request using Info="GDMA"
📥 TourPlan Response XML: <?xml version="1.0" encoding="utf-8"?><!DOCTYPE Reply SYSTEM "hostConnect_5_05_000.dtd"><Reply><OptionInfoReply><Option><Opt>BBKPKCPKUZ CPKU2N</Opt><OptionNumber>102043</OptionNumber><OptGeneral><SupplierId>24025</SupplierId><SupplierName>Camp Kuzuma (Dir)</SupplierName><Description>Camp Kuzuma - 3 day package</Description><Description2 /><Comment>Operates daily</Comment><Comment2 /><Locality>BBK</Locality><LocalityDescription>Kasane Airport</LocalityDescription><Class>LU</Class><ClassDescription>Luxury</ClassDescription><Periods>2</Periods><SType>Y</SType><SCU>pkg</SCU><MinSCU>1</MinSCU><MaxSCU>9999</MaxSCU><VoucherName>Camp Kuzuma (Dir)</VoucherName><Address1>Kasuma Forestry Reserve</Address1><Address2 /><Address3>North-East District</Address3><Address4>Botswana</Address4><Address5 /><PostCode /><Single_Avail>Y</Single_Avail><Single_Ad_Max>1</Single_Ad_Max><Single_Max>1</Single_Max><Single_Max_With_Infants>999</Single_Max_With_Infants><Twin_Avail>Y</Twin_Avail><Twin_Ad_Max>2</Twin_Ad_Max><Twin_Max>3</Twin_Max><Twin_Max_With_Infants>999</Twin_Max_With_Infants><Double_Avail>Y</Double_Avail><Double_Ad_Max>2</Double_Ad_Max><Double_Max>3</Double_Max><Double_Max_With_Infants>999</Double_Max_With_Infants><Triple_Avail>N</Triple_Avail><Quad_Avail>N</Quad_Avail><InfantsAllowed>Y</InfantsAllowed><Infant_From>0</Infant_From><Infant_To>10</Infant_To><ChildrenAllowed>Y</ChildrenAllowed><Child_From>11</Child_From><Child_To>16</Child_To><AdultsAllowed>Y</AdultsAllowed><Adult_From>17</Adult_From><Adult_To>99</Adult_To><PromptForPuDo>N</PromptForPuDo><ButtonName>Packages</ButtonName><LastUpdate>2021-03-01T10:35:24Z</LastUpdate></OptGeneral><OptDateRanges /><OptAvail>-3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 -3 </OptAvail><Amenities><Amenity><AmenityLevel>S</AmenityLevel><AmenityCode>BW</AmenityCode><AmenityCategory>CTY</AmenityCategory><AmenityDescription>Botswana</AmenityDescription></Amenity></Amenities></Option></OptionInfoReply></Reply>